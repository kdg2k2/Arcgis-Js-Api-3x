<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Arcgis Js Api 3x</title>

        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/gh/kdg2k2/FontAwesome_6_Pro@main/css/all.min.css"
        />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            href="https://js.arcgis.com/3.41/esri/css/esri.css"
        />
        <link rel="stylesheet" href="css/style.css" />
    </head>
    <body>
        <div id="map"></div>

        <!-- Control Panel -->
        <div class="control-panel">
            <div class="card border-0 m-0">
                <div class="card-header">
                    <i class="bi bi-tools"></i> Công cụ vẽ và chỉnh sửa
                </div>
                <div class="card-body p-3">
                    <!-- Drawing Tools -->
                    <div class="row g-2">
                        <div class="col-md-6">
                            <button
                                id="drawBtn"
                                class="btn btn-primary btn-tool w-100"
                            >
                                <i class="bi bi-pentagon"></i> Vẽ
                            </button>
                        </div>
                        <div class="col-md-6">
                            <button
                                id="selectBtn"
                                class="btn btn-primary btn-tool w-100"
                            >
                                <i class="bi bi-cursor"></i> Chọn
                            </button>
                        </div>
                        <div class="col-md-6">
                            <button
                                id="splitBtn"
                                class="btn btn-warning btn-tool w-100"
                                disabled
                            >
                                <i class="bi bi-scissors"></i> Cắt
                            </button>
                        </div>
                        <div class="col-md-6">
                            <button
                                id="mergeBtn"
                                class="btn btn-success btn-tool w-100"
                                disabled
                            >
                                <i class="bi bi-union"></i> Gộp
                            </button>
                        </div>
                        <div class="col-md-6">
                            <button
                                id="editBtn"
                                class="btn btn-info btn-tool w-100"
                                disabled
                            >
                                <i class="bi bi-pencil-square"></i> Chỉnh sửa
                            </button>
                        </div>
                        <div class="col-md-6">
                            <button
                                id="clearBtn"
                                class="btn btn-danger btn-tool w-100"
                            >
                                <i class="bi bi-trash"></i> Xóa Tất Cả
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info Panel -->
        <div class="info-panel">
            <div class="card border-0 m-0">
                <div class="card-header">
                    <i class="bi bi-info-circle"></i> Thông tin & Hướng dẫn
                </div>
                <div class="card-body p-3">
                    <div class="mb-2">
                        <strong>Polygon:</strong>
                        <span id="polygonCount">0</span> |
                        <strong>Đã chọn:</strong>
                        <span id="selectedCount">0</span>
                    </div>
                    <div class="small">
                        <strong>Hướng dẫn:</strong>
                        <li>
                            <strong>Vẽ:</strong>
                            Click để tạo điểm, double-click kết thúc
                        </li>
                        <li>
                            <strong>Cắt:</strong>
                            Chọn 1 polygon, vẽ đường chia
                        </li>
                        <li>
                            <strong>Gộp:</strong>
                            Chọn 2+ polygon để gộp
                        </li>
                    </div>
                </div>
            </div>
        </div>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"
        ></script>
        <script src="/js/dojoConfig.js"></script>
        <script src="https://js.arcgis.com/3.41/"></script>
        <script>
            require(["arcgis/main"], function () {
                MapApp.createBaseMap("map");
                MapApp.initializePolygonManager();
                MapApp.initializeUIManager();
                MapApp.initializeToolManager();
                MapApp.bindToolEvents();
                MapApp.bindMapClick();

                window.currentLayerName = "ws_ranhgioi:rg_vn_tinh";
                const managers = MapApp.getManagers();

                MapApp.initializeWMSManager();
                managers.wms.addWMSLayer(window["currentLayerName"]);
            });
        </script>
    </body>
</html>
